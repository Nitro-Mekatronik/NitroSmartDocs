<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>How to write a plugin for nopCommerce </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="How to write a plugin for nopCommerce ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <link rel="preload" href="../../../fonts/fonts.css" )"="" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <meta property="docfx:navrel" content="/">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-7490022-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-7490022-8');
    </script>
    <script>
      /*! loadCSS. [c]2017 Filament Group, Inc. MIT License
      - testing support for link[rel=preload]
      - enabling async CSS loading in browsers that do not support rel=preload
      - applying rel preload css once loaded, whether supported or not.
      */
      !function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-loadcss")||(a.setAttribute("data-loadcss",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:n.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
    </script>
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="170">
    <div id="wrapper">
      <header>
        <div class="container">
          <div id="header" class="header navbar-header">
            <div class="header-logo">
              <a href="https://www.nopcommerce.com/">
                <img id="logo" class="svg" src="../../../logo.png" alt="">
              </a>
            </div>  </div>
          <div class="navbar-collapse collapse in">
            <form class="navbar-form navbar-right" role="search" id="search">
              <div class="form-group">
                <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
              </div>
        
              <div class="form-group lang-container">
                    
                    <select id="lang-switcher" class="select-css">
                        <option value="/en/index.html" selected="">
                          English
                        
                    </select>        </div>
            </form>
          </div>
        </div>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="en/developer/plugins/how-to-write-plugin-4.50">
<h1 id="how-to-write-a-plugin-for-nopcommerce" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="8">How to write a plugin for nopCommerce</h1>

<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="10">Plugins are used to extend the functionality of nopCommerce. nopCommerce has several types of plugins. For example, payment methods (such as PayPal), tax providers, shipping method computation methods (such as UPS, USP, FedEx), widgets (such as 'live chat' block), and many others. nopCommerce is already distributed with many different plugins. You can also search various plugins on the <a href="https://www.nopcommerce.com/marketplace" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="10">nopCommerce official site</a> to see if someone has already created a plugin that suits your needs. If not, this article will guide you through the process of creating your plugin.</p>
<h2 id="the-plugin-structure-required-files-and-locations" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="12">The plugin structure, required files, and locations</h2>
<ol sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">First thing you need to do is to create a new <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">Class Library</code></em> project in the solution. It's a good practice to place all plugins into the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">\Plugins</code> directory in the root of your solution (do not mix up with <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">\Plugins</code> subdirectory located in <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">\Nop.Web</code> directory which is used for already deployed plugins). It's a good practice to place all plugins into the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="14">Plugins</code> solution folder.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">A recommended name for a plugin project is <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">Nop.Plugin.{Group}.{Name}</code></strong>. <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">{Group}</code></strong> is your plugin group (for example, <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">Payment</em> or <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">Shipping</em>). <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">{Name}</code></strong> is your plugin name (for example, <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">PayPalStandard</em>). For example, the PayPal Standard payment plugin has the following name: <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">Nop.Plugin.Payments.PayPalStandard</code></strong>. But please note that it's not a requirement. And you can choose any name for a plugin. For example, <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="16">MyGreatPlugin</code>.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="18"><img src="_static/how-to-write-plugin-4.50/write_plugin_4.50_1.jpg" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="18" alt="p1"></p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="20"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="20">Once the plugin project is created you have to open its <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="20">.csproj</code> file in any text editor and replace its content with the following one:</p>
<pre><code class="lang-xml" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="22">&lt;Project Sdk=&quot;Microsoft.NET.Sdk&quot;&gt;
    &lt;PropertyGroup&gt;
        &lt;TargetFramework&gt;net6.0&lt;/TargetFramework&gt;
        &lt;Copyright&gt;SOME_COPYRIGHT&lt;/Copyright&gt;
        &lt;Company&gt;YOUR_COMPANY&lt;/Company&gt;
        &lt;Authors&gt;SOME_AUTHORS&lt;/Authors&gt;
        &lt;PackageLicenseUrl&gt;PACKAGE_LICENSE_URL&lt;/PackageLicenseUrl&gt;
        &lt;PackageProjectUrl&gt;PACKAGE_PROJECT_URL&lt;/PackageProjectUrl&gt;
        &lt;RepositoryUrl&gt;REPOSITORY_URL&lt;/RepositoryUrl&gt;
        &lt;RepositoryType&gt;Git&lt;/RepositoryType&gt;
        &lt;OutputPath&gt;..\..\Presentation\Nop.Web\Plugins\PLUGIN_OUTPUT_DIRECTORY&lt;/OutputPath&gt;
        &lt;OutDir&gt;$(OutputPath)&lt;/OutDir&gt;
        &lt;!--Set this parameter to true to get the dlls copied from the NuGet cache to the output of your    project. You need to set this parameter to true if your plugin has a nuget package to ensure that   the dlls copied from the NuGet cache to the output of your project--&gt;
        &lt;CopyLocalLockFileAssemblies&gt;true&lt;/CopyLocalLockFileAssemblies&gt;
    &lt;/PropertyGroup&gt;
    &lt;ItemGroup&gt;
        &lt;ProjectReference Include=&quot;..\..\Presentation\Nop.Web.Framework\Nop.Web.Framework.csproj&quot; /&gt;
        &lt;ClearPluginAssemblies Include=&quot;$(MSBuildProjectDirectory)\..\..\Build\ClearPluginAssemblies.proj&quot; /&gt;
    &lt;/ItemGroup&gt;
    &lt;!-- This target execute after &quot;Build&quot; target --&gt;
    &lt;Target Name=&quot;NopTarget&quot; AfterTargets=&quot;Build&quot;&gt;
        &lt;!-- Delete unnecessary libraries from plugins path --&gt;
        &lt;MSBuild Projects=&quot;@(ClearPluginAssemblies)&quot; Properties=&quot;PluginPath=$(MSBuildProjectDirectory)\$(OutDir)&quot; Targets=&quot;NopClear&quot; /&gt;
    &lt;/Target&gt;
&lt;/Project&gt;
</code></pre>
<div class="TIP" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="50">
<h5>Tip</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="51">Where <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="51">PLUGIN_OUTPUT_DIRECTORY</strong> should be replaced with the plugin name, for example, <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="51">Payments.PayPalStandard</code>.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="53">We do it this way to be able to use a new approach to add third-party references which were introduced in .NET Core. But actually, it's not required. Moreover, references from already referenced libraries will be loaded automatically. So it is very convenient.</p>
</div>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="55"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="55">The next step is creating a <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="55">plugin.json</code> file required for each plugin. This file contains meta-information describing your plugin. Just copy this file from any other existing plugin and modify it for your needs. For information about the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="55">plugin.json</code> file, please see <a class="xref" href="plugin.json.html" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="55">plugin.json file</a></p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">The last required step is to create a class that implements <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">IPlugin</code></strong> interface (<code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">Nop.Services.Plugins</code> namespace). nopCommerce has <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">BasePlugin</code></strong> class which already implements some <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">IPlugin</code> methods and allows you to avoid source code duplication. nopCommerce also provides you with some specific interfaces derived from <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">IPlugin</code>. For example, we have the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">IPaymentMethod</code> interface which is used for creating new payment method plugins. It contains some methods which are specific only for payment methods such as <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">ProcessPaymentAsync()</code></em> or <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="57">GetAdditionalHandlingFeeAsync()</code></em>. Currently, nopCommerce has the following specific plugin interfaces:</p>
<ul sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="59">
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="59"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="59"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="59">IPaymentMethod</strong>. These plugins are used for payment processing.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="60"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="60"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="60">IShippingRateComputationMethod</strong>. These plugins are used for retrieving accepted delivery methods and appropriate shipping rates. For example, UPS, UPS, FedEx, etc.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="61"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="61"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="61">IPickupPointProvider</strong>. These plugins are used for providing pickup points.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="62"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="62"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="62">ITaxProvider</strong>. Tax providers are used for getting tax rates.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="63"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="63"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="63">IExchangeRateProvider</strong>. Used for getting currency exchange rate.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="64"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="64"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="64">IDiscountRequirementRule</strong>. Allows you to create new discount rules such as &quot;Billing country of a customer should be…&quot;</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="65"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="65"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="65">IExternalAuthenticationMethod</strong>. Used for creating external authentication methods such as Facebook, Twitter, OpenID, etc.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="66"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="66"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="66">IMultiFactorAuthenticationMethod</strong>. Used for creating multi-factor authentication methods such as <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="66">GoogleAuthenticator</em>, etc.</p>
<div class="NOTE" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="67">
<h5>Note</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="68">This is a new interface, since version 4.40 we provide the corresponding infrastructure for MFA integrations out of the box.</p>
</div>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="70"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="70"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="70">IWidgetPlugin</strong>. It allows you to create widgets. Widgets are rendered on some parts of your site. For example, it can be a &quot;Live chat&quot; block on your site's left column.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="71"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="71"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="71">IMiscPlugin</strong>. If your plugin doesn't fit any of the interfaces above.</p>
</li>
</ul>
</li>
</ol>
<div class="IMPORTANT" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="73">
<h5>Important</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="74">After each project build, clean the solution before making changes. Some resources will be cached and can lead to developer insanity.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="76">You may need to rebuild your solution after adding your plugin. If you do not see DLLs for your plugin under <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="76">Nop.Web\Plugins\PLUGIN_OUTPUT_DIRECTORY</code>, you need to rebuild your solution. nopCommerce will not list your plugin in the <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="76">Local Plugins</em> page if your DLLs do not exist in the correct folder in <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="76">Nop.Web</code>.</p>
</div>
<h2 id="handling-requests-controllers-models-and-views" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="78">Handling requests. Controllers, models, and views</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="80">Now you can see the plugin by going to <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="80">Admin area → Configuration → Local Plugins</strong>. But as you guessed our plugin does nothing. It does not even have a user interface for its configuration. Let's create a page to configure the plugin.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="82">What we need to do now is create a controller, a model, and a view.</p>
<ol sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="84">
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="84">MVC controllers are responsible for responding to requests made against an ASP.NET Core MVC website. Each browser request is mapped to a particular controller.</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="85">A view contains the HTML markup and content that is sent to the browser. A view is the equivalent of a page when working with an <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="85">ASP.NET Core MVC</code> application.</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="86">An MVC model contains all of your application logic that is not contained in a view or a controller.</li>
</ol>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="88">You can find more information about the MVC pattern <a href="https://docs.microsoft.com/aspnet/core/mvc/overview?view=aspnetcore-6.0" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="88">here</a>.</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="90">So let's start:</p>
<ul sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="92">
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="92"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="92"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="92">Create the model</strong>. Add a <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="92">Models</strong> folder in the new plugin, and then add a new model class that fits your need.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">Create the view</strong>. Add a <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">Views</strong> folder in the new plugin, and then add a <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">*.cshtml</code> file named <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">Configure.cshtml</code>. Set <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">&quot;Build Action&quot;</strong> property of the view file is set to <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">&quot;Content&quot;</strong>, and the <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">&quot;Copy to Output Directory&quot;</strong> property is set to <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">&quot;Copy always&quot;</strong>. Note that configuration page should use <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="93">_ConfigurePlugin</code> layout.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="94"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="94">Also make sure that you have the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="94">_ViewImports.cshtml</code> file into your \Views directory. You can just copy it from any other existing plugin.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95">Create the controller</strong>. Add a <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95">Controllers</strong> folder in the new plugin, and then add a new controller class. A good practice is to name plugin controllers <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95">{Group}{Name}Controller.cs</code>. For example, PaymentPayPalStandardController. Of course, it's not a requirement to name controllers this way (but just a recommendation). Then create an appropriate action method for the configuration page (in the admin area). Let's name it <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95">Configure</code></em>. Prepare a model class and pass it to the following view using a physical view path: <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="95">~/Plugins/{PluginOutputDirectory}/Views/Configure.cshtml</code>.</p>
</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="96"><p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="96">Use the following attributes for your action method:</p>
<pre><code class="lang-csharp" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="98">[AutoValidateAntiforgeryToken]
[AuthorizeAdmin] //confirms access to the admin panel
[Area(AreaNames.Admin)] //specifies the area containing a controller or action
</code></pre>
<div class="TIP" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="104">
<h5>Tip</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="105">You can also add these attributes directly to the controller. In this case, there is no need to tag each method with them.</p>
</div>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="107">For example, open <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="107">PayPalStandard</code> payment plugin and look at its implementation of <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="107">PaymentPayPalStandardController</code>.</p>
</li>
</ul>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="109">Then for each plugin that has a configuration page, you should specify a configuration URL. Base class named <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="109">BasePlugin</code> has <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="109">GetConfigurationPageUrl</code> method which returns a configuration URL:</p>
<pre><code class="lang-csharp" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="111">public override string GetConfigurationPageUrl()
{
    return $&quot;{_webHelper.GetStoreLocation()}Admin/{CONTROLLER_NAME}/{ACTION_NAME}&quot;;
}
</code></pre>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="118">Where <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="118">{CONTROLLER_NAME}</strong> is the name of your controller and <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="118">{ACTION_NAME}</strong> is the name of the action (usually it's <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="118">Configure</code>).</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="120">Once you have installed your plugin and added the configuration method you will find a link to configure your plugin under <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="120">Admin → Configuration → Local Plugins</strong>.</p>
<div class="TIP" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="122">
<h5>Tip</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="123">The easiest way to complete the steps described above is by opening any other plugin and copying these files into your plugin project. Then just rename appropriate classes and directories.</p>
</div>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="125">For example, the project structure of the <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="125">PayPalStandard</em> plugin looks like the image below:</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="127"><img src="_static/how-to-write-plugin-4.50/write_plugin_4.50_3.jpg" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="127" alt="p3"></p>
<h2 id="handling-installasync-uninstallasync-and-updateasync-methods" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="129">Handling &quot;InstallAsync&quot;, &quot;UninstallAsync&quot; and &quot;UpdateAsync&quot; methods</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="131">This step is optional. Some plugins can require additional logic during plugin installation. For example, a plugin can insert new locale resources. So open your <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="131">IPlugin</code> implementation (in most cases it'll be derived from the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="131">BasePlugin</code> class) and override the following methods:</p>
<ol sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="133">
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="133"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="133">InstallAsync</strong>. This method will be invoked during plugin installation. You can initialize any settings here, insert new locale resources, or create some new database tables (if required).</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="134"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="134">UninstallAsync</strong>. This method will be invoked during plugin uninstallation.</li>
<li sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="135"><strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="135">UpdateAsync</strong>. This method will be invoked during plugin update (when its version is changed in the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="135">plugin.json</code> file).</li>
</ol>
<div class="IMPORTANT" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="137">
<h5>Important</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="138">If you override one of these methods, do not hide its base implementation.</p>
</div>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140">For example, overridden <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140">InstallAsync</code> method should include the following method call: <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140"><code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140">base.Install()</code></em>. The <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140">InstallAsync</code> method of the <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="140">PayPalStandard</em> plugin looks like the code below</p>
<pre><code class="lang-csharp" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="142">public override async Task InstallAsync()
{
    await _settingService.SaveSettingAsync(new PayPalStandardPaymentSettings
    {
        UseSandbox = true
    });
    
    await _localizationService.AddLocaleResourceAsync(new Dictionary&lt;string, string&gt;
    {
        ...
    });
    await base.InstallAsync();
}
</code></pre>
<div class="TIP" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="158">
<h5>Tip</h5>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="159">The list of installed plugins is located in <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="159">\App_Data\plugins.json</code>. The list is created during installation.</p>
</div>
<h2 id="routes" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="161">Routes</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="163">Here we will have a look at how to register plugin routes. ASP.NET Core routing is responsible for mapping incoming browser requests to particular MVC controller actions. You can find more information about routing <a href="https://docs.microsoft.com/aspnet/core/fundamentals/routing" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="163">here</a>. So follow the next steps:</p>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="165">If you need to add some custom route, then create the <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="165">RouteProvider.cs</code> file. It informs the nopCommerce system about plugin routes. For example, the following <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="165">RouteProvider</code> class adds a new route which can be accessed by opening your web browser and navigating to <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="165">http://www.yourStore.com/Plugins/PaymentPayPalStandard/PDTHandler</code> URL (used by <em sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="165">PayPal</em> plugin):</p>
<pre><code class="lang-csharp" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="167">public partial class RouteProvider : IRouteProvider
{
    public void RegisterRoutes(IEndpointRouteBuilder endpointRouteBuilder)
    {
        //PDT
        endpointRouteBuilder.MapControllerRoute(&quot;Plugin.Payments.PayPalStandard.PDTHandler&quot;, &quot;Plugins/PaymentPayPalStandard/PDTHandler&quot;,
                new { controller = &quot;PaymentPayPalStandard&quot;, action = &quot;PDTHandler&quot; });
    }
    public int Priority =&gt; -1;
}
</code></pre>
<h2 id="upgrading-nopcommerce-may-break-plugins" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="180">Upgrading nopCommerce may break plugins</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="182">Some plugins may become outdated and no longer work with the newer version of nopCommerce. If you have issues after upgrading to the newer version, delete the plugin and visit the official nopCommerce website to see if a newer version is available. Many plugin authors will upgrade their plugins to accommodate the newer version, however, some will not and their plugin will become obsolete with the improvements in nopCommerce. But in most cases, you can simply open an appropriate <code sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="182">plugin.json</code> file and update the <strong sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="182">SupportedVersions</strong> field.</p>
<h2 id="conclusion" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="184">Conclusion</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="186">Hopefully, this will get you started with nopCommerce and prepare you to build more elaborate plugins.</p>
<h2 id="plugin-template" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="188">Plugin template</h2>
<p sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="190">You can use our Visual Studio template for new nopCommerce plugins. It can save a lot of time for developers because now they don't have to do manually all initial steps. Such as folders creation (Controllers, Views, Models etc.), other required files (DependencyRegistrar.cs, _ViewImports.cshtml, ObjectContex, plugin.json etc), configuration, project references, etc). Please find it and installation instructions <a href="https://github.com/nopSolutions/nopCommerce-plugin-template-VS/" sourcefile="en/developer/plugins/how-to-write-plugin-4.50.md" sourcestartlinenumber="190">here</a></p>

                  <div class="course-banner">
                      <a target="_blank" href="https://www.nopcommerce.com/training?utm_source=docs_nopcommerce&utm_medium=documentation&utm_campaign=course&utm_content=Developers_Guide">
                          <div class="course-banner-left"></div>
                          <div class="course-banner-center">
                              <div class="course-banner-title"><span>nopCommerce training course</span></div>
                              <div class="course-banner-description"><span>Start developing your skills and become a Certified Developer</span></div>
                          </div>
                          <div class="course-banner-right"></div>
                      </a> 
                  </div>            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nopSolutions/nopCommerce-Docs/blob/master/en/developer/plugins/how-to-write-plugin-4.50.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
